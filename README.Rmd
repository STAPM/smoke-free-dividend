---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# The potential smoke-free dividend from quitting for smokers across local areas in England: A cross-sectional analysis - code repository

  
<!-- badges: start -->
[![Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed.](https://www.repostatus.org/badges/latest/active.svg)](https://www.repostatus.org/#active)
[![Lifecycle: maturing](https://img.shields.io/badge/lifecycle-maturing-blue.svg)](https://www.tidyverse.org/lifecycle/#maturing)
<!-- badges: end -->

```{r}
#| label: load-packages
#| include: false

source("R/003 - load packages.R")

```

## Introduction

The purpose of this repository is to provide reproducible code and data inputs to produce the results of the paper "The potential smoke-free dividend from quitting for smokers across local areas in England: A cross-sectional analysis". 

## Requirements

All data inputs required are available in the repository or part of the R package `smkfreediv` which is open source and available on [GitHub](https://github.com/STAPM/smkfreediv). The exception to this is the Smoking Toolkit Study (STS) data which cannot be provided.

### R Package

The analysis requires the use of the `smkfreediv` R package, which contains functions and data inputs needed to calculate the amount of upshifting required to account for underreporting of spending data in the STS and to combine data sources to calculate the smoke free dividend. The version of `smkfreediv` which produced the analysis in the paper is 1.6.2. It is not guaranteed that the code in this repository will still work with later versions of the package.

### Smoking Toolkit Study

In order to run the analysis the user must provide their own version of the STS data. The raw SPSS file for the STS data must be stored in the `input_data/` directory within the project repository and the name of the file (including .sav extension) should be updated in the `data_file` object created in the `run_analyses.R` file located in the root directory of the repository. e.g. for the April 2021 data the paper was produced using:

```{r, eval=FALSE}
data_file <- "omni174_39.1_65.2cot_31.3a_25.4s_recodes_60.5sa.sav"
```

## Reproducibility 

Note that this repository uses the `renv` R package to produce a reproducible environment for this analysis. see [the package website](https://rstudio.github.io/renv/articles/renv.html) for more information.

The current versions of the packages used are stored in the `renv.lock` file in the top level of the repository, and this is used to populate the libraries within the `renv` folder. The .Rprofile file in the top level of the repository is automatically run when the project is opened and this runs the script file `renv/activate.R` to set the renv folder as the source R package library.

## Citation
Please cite as:


## Computational environment

This repository was last updated on `r Sys.time()` and used the following computational environment and dependencies:

```{r}
#| cache: false

# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```




